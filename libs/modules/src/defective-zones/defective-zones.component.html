<ion-content class="ion-padding">
  <ion-text color="primary">
    <suite-breadcrumb></suite-breadcrumb>
  </ion-text>
  <ion-grid>
    <ion-row>
      <ion-col>
        <mat-accordion multi="false">
          <mat-expansion-panel *ngFor="let defect of groupsDefectiveZones; let i = index" (opened)="openGroup(defect.id)" [expanded]="defect.open">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <ion-checkbox style="margin-right: 5px" (click)="activateDelete(defect)"></ion-checkbox>
                {{ defect.name }}
              </mat-panel-title>
            </mat-expansion-panel-header>

            <ion-item class="no-border">
              <ion-button slot="end" color="dark" *ngIf="defect.addedChild" (click)="addDefectiveChild(defect.id)"><ion-icon name="add"></ion-icon></ion-button>
              <ion-button slot="end" color="dark" *ngIf="defect.updateChild" (click)="updateDefectiveChild()"><ion-icon name="create"></ion-icon></ion-button>
              <ion-button slot="end" color="danger" *ngIf="defect.deletedChild" (click)="presentDeleteChildrenAlert(defect.id)"><ion-icon name="trash"></ion-icon></ion-button>
              <h2>Subzonas</h2>
            </ion-item>
            <ion-grid>
              <ion-row>
                <ion-col></ion-col>
                <ion-col class="centerText">Incluir en ticket incidencia</ion-col>
                <ion-col class="centerText">Incluir en albarán devolución</ion-col>
              </ion-row>
              <ion-row *ngFor="let child of defect.defectZoneChild">
                <ion-col>
                  <ion-checkbox class="innerCheckbox" (click)="onChanged(i, defect.id, child)"></ion-checkbox>
                  {{child.name}}
                </ion-col>
                <ion-col class="centerText">
                  <ion-checkbox [(ngModel)]="child.includeInIncidenceTicket" (ionChange)="storeChanges()"></ion-checkbox>
                </ion-col>
                <ion-col class="centerText">
                  <ion-checkbox [(ngModel)]="child.includeInDeliveryNote" (ionChange)="storeChanges()"></ion-checkbox>
                </ion-col>
              </ion-row>
            </ion-grid>
            <p class="ion-text-center" *ngIf="defect.defectZoneChild.length === 0"> No existen datos</p>
          </mat-expansion-panel>
        </mat-accordion>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
<ion-fab vertical="bottom" horizontal="end">
  <ion-fab-button matTooltip="Nueva Zona" matTooltipClass="tooltip" *ngIf="!toSelectGroup" (click)="addDefective()">
    <ion-icon name="add"></ion-icon>
  </ion-fab-button>
  <div style="height: 5px"></div>
  <ion-fab-button matTooltip="Actualizar" matTooltipClass="tooltip" *ngIf="groupsToSelect.length === 1" (click)="updateDefective()">
    <ion-icon name="create"></ion-icon>
  </ion-fab-button>
  <div style="height: 5px"></div>
  <ion-fab-button matTooltip="Eliminar" matTooltipClass="tooltip" *ngIf="toSelectGroup" (click)="presentDeleteAlert()" color="danger">
    <ion-icon name="trash"></ion-icon>
  </ion-fab-button>
  <div style="height: 5px"></div>
  <ion-fab-button matTooltip="Guardar cambios" matTooltipClass="tooltip" *ngIf="thereAreChanges" (click)="saveChanges()">
    <ion-icon name="save"></ion-icon>
  </ion-fab-button>
</ion-fab>
