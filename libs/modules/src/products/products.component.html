<ion-content padding="true">

  <ion-text color="primary">
    <suite-breadcrumb></suite-breadcrumb>
    <ion-icon name="refresh" (click)="eraseFilters()" [matTooltip]="'Reiniciar filtros'"></ion-icon>
  </ion-text>

  <div class="mat-table-wrapper-overflow-x">
    <table mat-table [dataSource]="dataSource">

      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>

      <tr mat-row (click)="goDetails(row)" *matRowDef="let row; columns: displayedColumns"></tr>

      <ng-container matColumnDef="reference">
        <th mat-header-cell *matHeaderCellDef>
          <span class="title" (click)="sort('reference')">Código</span>
          <suite-filter-button
            #filterButtonReferences
            class="filter"
            [title]="'Código'"
            [listItems]="references"
            [isFiltering]="isFilteringReferences != references.length"
            (applyFilters)="applyFilters($event, 'references')">
          </suite-filter-button>
        </th>
        <td mat-cell *matCellDef="let product">
          {{ product?.productShoeUnit?.reference }}
        </td>
      </ng-container>

      <ng-container matColumnDef="model">
        <th mat-header-cell *matHeaderCellDef>
          <span class="title" (click)="sort('model')">Referencia</span>
          <suite-filter-button
            #filterButtonModels
            class="filter"
            [title]="'Referencia'"
            [listItems]="models"
            [isFiltering]="isFilteringModels != models.length"
            (applyFilters)="applyFilters($event, 'models')">
          </suite-filter-button>
        </th>
        <td mat-cell *matCellDef="let product">
          {{ product?.productShoeUnit?.model?.reference }}
        </td>
      </ng-container>

      <ng-container matColumnDef="color">
        <th mat-header-cell *matHeaderCellDef>
          <span class="title" (click)="sort('color')">Color</span>
          <suite-filter-button
            #filterButtonColors
            class="filter"
            [title]="'Color'"
            [listItems]="colors"
            [isFiltering]="isFilteringColors != colors.length"
            (applyFilters)="applyFilters($event, 'colors')">
          </suite-filter-button>
        </th>
        <td mat-cell *matCellDef="let product">
          {{ product?.productShoeUnit?.model?.color?.name }}
        </td>
      </ng-container>

      <ng-container matColumnDef="size">
        <th mat-header-cell *matHeaderCellDef>
          <span class="title" (click)="sort('size')">Talla</span>
          <suite-filter-button
            #filterButtonSizes
            class="filter"
            [title]="'Talla'"
            [listItems]="sizes"
            [isFiltering]="isFilteringSizes != sizes.length"
            (applyFilters)="applyFilters($event, 'sizes')">
          </suite-filter-button>
        </th>
        <td mat-cell *matCellDef="let product">
          {{ product?.productShoeUnit?.size?.name }}
        </td>
      </ng-container>

      <ng-container matColumnDef="warehouse">
        <th mat-header-cell *matHeaderCellDef>
          <span class="title" (click)="sort('warehouse')">Almacén</span>
          <suite-filter-button
            #filterButtonWarehouses
            class="filter"
            [title]="'Almacén'"
            [listItems]="warehouses"
            [isFiltering]="isFilteringWarehouses != warehouses.length"
            (applyFilters)="applyFilters($event, 'warehouses')">
          </suite-filter-button>
        </th>
        <td mat-cell *matCellDef="let product">
          {{ product?.warehouse?.reference }}
        </td>
      </ng-container>

      <ng-container matColumnDef="container">
        <th mat-header-cell *matHeaderCellDef>
          <span class="title" (click)="sort('container')">Ubicación</span>
          <suite-filter-button
            #filterButtonContainers
            class="filter"
            [title]="'Ubicación'"
            [listItems]="containers"
            [isFiltering]="isFilteringContainers != containers.length"
            (applyFilters)="applyFilters($event, 'containers')">
          </suite-filter-button>
        </th>
        <td mat-cell *matCellDef="let product">
          {{ getProductLocation(product) }}
        </td>
      </ng-container>

      <ng-container matColumnDef="brand">
        <th mat-header-cell *matHeaderCellDef>
          <span class="title" (click)="sort('brand')">Marca</span>
          <suite-filter-button
            #filterButtonBrands
            class="filter"
            [title]="'Marca'"
            [listItems]="brands"
            [isFiltering]="isFilteringBrands != brands.length"
            (applyFilters)="applyFilters($event, 'brands')">
          </suite-filter-button>
        </th>
        <td mat-cell *matCellDef="let product">
          {{ product?.productShoeUnit?.model?.brand?.name }}
        </td>
      </ng-container>

      <ng-container matColumnDef="supplier">
        <th mat-header-cell *matHeaderCellDef>
          <span class="title" (click)="sort('supplier')">Proveedor</span>
          <suite-filter-button
            #filterButtonSuppliers
            class="filter"
            [title]="'Proveedor'"
            [listItems]="suppliers"
            [isFiltering]="isFilteringSuppliers != suppliers.length"
            (applyFilters)="applyFilters($event, 'suppliers')">
          </suite-filter-button>
        </th>
        <td mat-cell *matCellDef="let product">
          {{ product?.productShoeUnit?.model?.brand?.supplierName }}
        </td>
      </ng-container>

      <ng-container matColumnDef="select" [formGroup]="selectedForm">
        <th mat-header-cell *matHeaderCellDef>
          <ion-checkbox (ionChange)="selectAll($event)"></ion-checkbox>
        </th>
        <td mat-cell *matCellDef="let product;let i = index" (click)="prevent($event)">
          <ng-template [ngIf]="selectedForm['controls']?.toSelect">
            <ion-checkbox [formControl]="selectedForm['controls']?.toSelect['controls'][i]"></ion-checkbox>
          </ng-template>
        </td>
      </ng-container>

    </table>
  </div>

  <suite-paginator [pagerValues]="pagerValues"></suite-paginator>

</ion-content>

<ion-fab vertical="bottom" horizontal="end">
  <ion-fab-button (click)="printPriceProducts()" *ngIf="selectedForm['controls']?.toSelect && selectedForm.valid">
    <ion-icon name="print"></ion-icon>
    <ion-icon name="logo-usd"></ion-icon>
  </ion-fab-button>
  <div style="height: 5px"></div>
  <ion-fab-button (click)="printLabelProducts()" *ngIf="selectedForm['controls']?.toSelect && selectedForm.valid">
    <ion-icon name="print"></ion-icon>
    <ion-icon name="pricetag"></ion-icon>
  </ion-fab-button>
</ion-fab>
