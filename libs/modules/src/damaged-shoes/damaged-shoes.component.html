<ion-content>
  <ion-row>
    <ion-col id="reset">
      <ion-button (click)="resetFilters()" matTooltip="Reiniciar filtros" matTooltipClass="tooltip">
        <ion-icon name="refresh"></ion-icon>
      </ion-button>
    </ion-col>
  </ion-row>
  <div class="table-container">
    <mat-table [dataSource]="tablePermissions">
      <ng-container matColumnDef="classification">
        <mat-header-cell *matHeaderCellDef>
          <span class="title">Clasificación</span>
          <mat-icon (click)="openFilter('Clasificaciones')">{{isFiltering('classification')}}</mat-icon>
        </mat-header-cell>
        <mat-cell *matCellDef="let permission">{{permission.classification.name}}</mat-cell>
      </ng-container>
      <ng-container matColumnDef="status">
        <mat-header-cell *matHeaderCellDef>
          <span class="title">Estado</span>
          <mat-icon (click)="openFilter('Estados')">{{isFiltering('status')}}</mat-icon>
        </mat-header-cell>
        <mat-cell *matCellDef="let permission">{{permission.status.name}}</mat-cell>
      </ng-container>
      <ng-container *ngFor="let action of tableActions; let i = index" matColumnDef="{{action.id}}">
        <mat-header-cell *matHeaderCellDef class="center">
          <span class="title">{{action.name}}</span>
        </mat-header-cell>
        <mat-cell *matCellDef="let permission" class="center">
          <mat-checkbox [checked]="isChecked(action, permission.actions)" (change)="changeAction(action, permission.id)"></mat-checkbox>
        </mat-cell>
      </ng-container>
      <mat-header-row *matHeaderRowDef="tableColumns; sticky: true"></mat-header-row>
      <mat-row *matRowDef="let permission; columns: tableColumns;"></mat-row>
    </mat-table>
  </div>
</ion-content>
<ion-fab vertical="bottom" horizontal="end">
  <ion-row>
    <ion-col>
      <ion-fab-button color="dark"  matTooltip="Guardar cambios" matTooltipClass="tooltip" matTooltipPosition="above" (click)="saveChanges()" *ngIf="thereAreChanges">
        <ion-icon name="save"></ion-icon>
      </ion-fab-button>
    </ion-col>
    <ion-col>
      <ion-fab-button color="dark"  matTooltip="Añadir nuevo rol a usuario" matTooltipClass="tooltip" matTooltipPosition="above" (click)="newAction()">
        <ion-icon name="add"></ion-icon>
      </ion-fab-button>
    </ion-col>
    <ion-col>
      <ion-fab-button color="dark"  matTooltip="Deshacer cambios no guardados" matTooltipClass="tooltip" matTooltipPosition="above" (click)="ngOnInit()">
        <ion-icon name="undo"></ion-icon>
      </ion-fab-button>
    </ion-col>
  </ion-row>
</ion-fab>
