<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-button (click)="goToList()">
        <ion-icon name="close" class="toogleArrow"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{ title }}</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content>
  <mat-tab-group mat-stretch-tabs>
    <mat-tab label="Listado">
      <ng-container [ngTemplateOutlet]="listProductsContainer"></ng-container>
    </mat-tab>
    <mat-tab label="Historial">
      <ng-container [ngTemplateOutlet]="historyContainer"></ng-container>
    </mat-tab>
  </mat-tab-group>

  <ng-template #listProductsContainer let-lessonsCounter="estimate">
    <mat-accordion class="accordion-products">
      <mat-expansion-panel *ngFor="let product of listProducts">
        <mat-expansion-panel-header>
          <mat-panel-title>
            {{product.reference}}
          </mat-panel-title>
          <mat-panel-description>
            {{product.name}}
          </mat-panel-description>
        </mat-expansion-panel-header>

        <p>I'm visible because I am open</p>
      </mat-expansion-panel>
    </mat-accordion>

    <ion-footer class="footer-products">
      <ion-fab vertical="bottom" horizontal="end" class="horizontal-fab">
        <ion-fab-button color="light" (click)="scanProduct()"><ion-icon name="barcode"></ion-icon></ion-fab-button>
        <ion-fab-button color="light"><i class="material-icons">print</i></ion-fab-button>
        <ion-fab-button (click)="addProduct()"><i class="material-icons">add</i></ion-fab-button>
      </ion-fab>
    </ion-footer>

  </ng-template>

  <ng-template #historyContainer let-lessonsCounter="estimate">
    <mat-accordion class="accordion-history">
      <mat-expansion-panel *ngFor="let productHistory of listHistory">
        <mat-expansion-panel-header>
          <mat-panel-title>
            {{productHistory.reference}}
          </mat-panel-title>
          <mat-panel-description>
            {{productHistory.name}}
          </mat-panel-description>
        </mat-expansion-panel-header>

        <p>Almacén de origen:
          <span class="value-history">
            {{productHistory.origin_warehouse ? (productHistory.origin_warehouse.reference + ' - ' + productHistory.origin_warehouse.name) : 'No registrado'}}
          </span>
        </p>
        <p>Almacén de destino:
          <span class="value-history">
            {{productHistory.destination_warehouse ? (productHistory.destination_warehouse.reference + ' - ' + productHistory.destination_warehouse.name) : 'No registrado'}}
          </span>
        </p>
        <p>Empleado: <span class="value-history">{{productHistory.user.name}} (<span class="email-address">{{productHistory.user.email}}</span>)</span></p>
        <p>Añadido: <span class="value-history">{{productHistory.date_add}}</span></p>
        <p>Modificado: <span class="value-history">{{productHistory.date_upd}}</span></p>
        <p>Errores: <span class="value-history">{{productHistory.errors}}</span></p>
      </mat-expansion-panel>
    </mat-accordion>
  </ng-template>
</ion-content>
